from pwn import *

context.arch = "x86_64"
#context.arch = "aarch64"

TEXT = "hello world!\n"
sh = shellcraft.open("/etc/passwd");
sh += "sub rsp, 0x1000\n" # need space on stack
sh += shellcraft.read(3, 'rsp', 0x1000) 
sh += shellcraft.write(1, 'rsp', 'rax')
sh += "add rsp, 0x1000\n" # restore stack - not needed in exploit :)

print(sh)

sh += shellcraft.exit(0)

elf = ELF.from_assembly(sh)
elf.save("show_passwd")
